<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Postcard + QR (for Shruti)</title>

<!-- cute + readable fonts -->
<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@700;800&family=Quicksand:wght@400;600;700&family=Satisfy&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Pacifico&family=Sacramento&display=swap" rel="stylesheet">

<style>
:root{
  --bg1:#0c1022; --bg2:#14102e; --ink:#eaf2ff; --muted:#cdd5f9; --accent:#ff9ccc; --edge:rgba(255,255,255,.14);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  background:
    radial-gradient(900px 440px at 50% -12%, rgba(141, 190, 228, 0.641), transparent 60%),
    linear-gradient(180deg,var(--bg1),var(--bg2));
  font-family: Quicksand, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
  display:grid; place-items:center; padding:24px;
}
.wrap{
  width:min(980px,94vw);
  border:1px solid var(--edge);
  border-radius:18px;
  background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));
  box-shadow:0 22px 48px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.05);
  padding:18px;
}
h1{
  font-family: "Fraunces", serif;
  margin:0 0 4px;
  font-weight:800; letter-spacing:.2px;
  background: linear-gradient(180deg, #e9edff 0%, #d9dfff 60%, #bfc8ff 100%);
  -webkit-background-clip:text; background-clip:text; color:transparent;
}
.small{color:var(--muted); margin:0 0 12px}
.grid{
  display:grid; gap:14px;
  grid-template-columns: 1fr;
}
.panel{
  display:grid; gap:10px;
}
label{font-size:13px; color:var(--muted)}
input[type="text"], textarea, select{
  width:100%; color:var(--ink);
  background:rgba(255,255,255,.04);
  border:1px solid var(--edge);
  border-radius:12px; padding:10px 12px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.04);
}
textarea{min-height:96px; resize:vertical}
.btns{display:flex; gap:10px; flex-wrap:wrap}
button{
  appearance:none; border:0; cursor:pointer; font-weight:800; letter-spacing:.2px;
  color:#0c0f17; padding:12px 18px; border-radius:999px;
  background:linear-gradient(90deg,var(--accent),#c9a7ff);
  box-shadow:0 12px 24px rgba(0,0,0,.28);
}
button:active{transform:translateY(1px) scale(.99)}
canvas{
  width:100%; height:auto; display:block;
  border-radius:16px; border:1px solid var(--edge);
  box-shadow:0 18px 44px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.05);
  background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
}
.hr{height:1px;background:linear-gradient(90deg,transparent,rgba(255,255,255,.14),transparent)}
.note{font-size:12px; color:var(--muted)}

/* === SPRING THEME PACK (page chrome only) ======================== */
body.spring{
  --ink:#1b2230;
  --muted:#4b5a79;
  --accent:#52d6a0;
  --accent-2:#ffd86e;
  --accent-3:#ffb7c5;
  --panel:rgba(255,255,255,.86);
  --edge:rgba(0,0,0,.06);
  --glow:rgba(82,214,160,.18);
  --bg1:#fff9fb;
  --bg2:#f3ffe8;
  color:var(--ink);
  background:
    radial-gradient(900px 420px at 50% -12%, rgba(255,183,197,.28), transparent 60%),
    radial-gradient(1100px 600px at 20% 120%, rgba(173, 255, 201, .25), transparent 60%),
    linear-gradient(180deg, var(--bg1), var(--bg2));
}
body.spring .wrap{
  background:var(--panel);
  border:1px solid var(--edge);
  box-shadow:
    0 22px 48px var(--glow),
    0 12px 26px rgba(0,0,0,.08),
    inset 0 1px 0 rgba(255,255,255,.45);
  backdrop-filter:saturate(115%) blur(3px);
}
</style>
</head>

<body class="spring">
  <div class="wrap">
    <h1>Postcard + QR</h1>
    <p class="small">Make a postcard PNG you can send on Snapchat. Scanning opens your surprise page.</p>
    
    <div class="grid">
      <div class="panel">
        <label>Message (handwritten on the card)</label>
        <textarea id="msg">Today the world feels brighter, because it carries your light. Happy Birthday to the one who makes learning and living equally beautiful.</textarea>
        
        <label for="pcTheme">Theme</label>
        <select id="pcTheme">
          <option value="classic">Classic Night</option>
          <option value="spring">Spring Blossom</option>
          <option value="gulabi">Gulabi (Pink)</option>
          <option value="denim">Denim (Blue)</option>
          <option value="aurora">Aurora Candy</option>
          <option value="kraft">Kraft & Gold</option>
          <option value="lavender">Midnight Lilac</option>
        </select>

        <label>Footer (tiny line)</label>
        <input id="footer" type="text" value="From Dev, with a silly grin and a lot of care ü§ç"/>

        <label>Link to open (QR target)</label>
        <input id="url" type="text" value="https://devsharma31.github.io/happy-birthday/"/>

        <label>Title (top heading)</label>
        <input id="title" type="text" value="A little note for you"/>

        <label>Font style for message</label>
        <select id="pcFont">
        <option value="auto" selected>Auto (per theme)</option>
        <option value="clean">Clean (Quicksand)</option>
        <option value="cursive">Cursive (Pacifico)</option>
        <option value="elegant">Elegant Script (Great Vibes)</option>
        </select>

        <label>Format</label>
        <select id="fmt">
          <option value="card">Landscape Card ‚Äî 1200 √ó 720 (nice share)</option>
          <option value="story">Vertical Story ‚Äî 1080 √ó 1920 (Snap-friendly)</option>
          <option value="square">Square ‚Äî 1080 √ó 1080</option>
        </select>

        <div class="btns">
          <button id="render">Generate / Refresh</button>
          <button id="download">Download PNG</button>
        </div>
        <p class="note">Tip: tweak text, hit ‚ÄúGenerate‚Äù, then ‚ÄúDownload‚Äù.</p>
      </div>

      <div class="hr"></div>

      <!-- preview canvas -->
      <canvas id="pcCanvas" width="1200" height="720"></canvas>
    </div>

    <!-- hidden QR render target (not used by this lib, kept just in case) -->
    <div id="qrTmp" style="position:absolute;left:-9999px;top:-9999px"></div>
  </div>

<!-- Single QR library (modern) -->
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>
<script>
/* ----------  THEMES  (panel + ink are now theme-aware) ---------- */
const THEMES = {
  // dreamy pastel sky with candy bokeh
  aurora: {
    name: 'Aurora Candy',
    bgStops: ['#f9e3ff','#e3f0ff'],
    panelBg: 'rgba(255,255,255,0.92)',
    panelStroke: 'rgba(0,0,0,0.07)',
    ink: '#172034',
    sub: '#556388',
    accent: '#ff8fb1',
    titleGrad: ['#ff8fb1','#c9a7ff','#ffd86e'],
    confetti: ['#ffc7d9','#cde8ff','#ffe7a3','#e2d0ff'],
    stickers: 'hearts',
    defaultFont: 'cursive'   // auto -> cursive
  },

  // bright spring with washi-tape vibe
  spring: {
    name: 'Spring Blossom',
    bgStops: ['#fff9fb','#f3ffe8'],
    panelBg: 'rgba(255,255,255,0.95)',
    panelStroke: 'rgba(0,0,0,0.06)',
    ink: '#1b2230',
    sub: '#4b5a79',
    accent: '#52d6a0',
    titleGrad: ['#4ccf9c','#fff0a3','#ffb7c5'],
    confetti: ['#ffcadb','#c8f7e2','#ffe59a','#c8e4ff'],
    stickers: 'daisies',
    defaultFont: 'cursive'
  },

  // cozy craft-paper + gold foil feel
  kraft: {
    name: 'Kraft & Gold',
    bgStops: ['#f1e6d1','#e7dcc2'],
    panelBg: '#f7efdf',
    panelStroke: 'rgba(120,90,40,0.25)',
    ink: '#2a230f',
    sub: '#5b4a2a',
    accent: '#caa45a',
    titleGrad: ['#b68b2e','#f6d06e','#fff2b7','#b68b2e'],
    confetti: ['#f1e6d1','#e9d9b9','#f6d06e'],
    stickers: 'ribbons',
    defaultFont: 'elegant'
  },

  // lavender dusk with tiny twinkles
  lavender: {
    name: 'Midnight Lilac',
    bgStops: ['#171a3a','#2a1e55'],
    panelBg: 'rgba(22,25,52,0.92)',
    panelStroke: 'rgba(255,255,255,0.10)',
    ink: '#eef2ff',
    sub: '#cdd5f9',
    accent: '#c9a7ff',
    titleGrad: ['#c9a7ff','#ffd2ea'],
    confetti: ['#c9a7ff','#ffd2ea','#a8b8ff'],
    stickers: 'stars',
    defaultFont: 'clean'
  },

  // your original dark night / denim ‚Äî
  denim: {
    name: 'Denim',
    bgStops: ['#0b1322','#0b1b33'],
    panelBg: 'rgba(17,22,40,0.86)',
    panelStroke: 'rgba(255,255,255,0.10)',
    ink: '#eaf2ff',
    sub: '#cfe0ff',
    accent: '#85a9ff',
    titleGrad: ['#85a9ff','#c9e0ff'],
    confetti: ['#99b8ff','#cfe0ff'],
    stickers: 'stars',
    defaultFont: 'clean'
  },

  // your original rosy night (kept)
  gulabi: {
    name: 'Gulabi',
    bgStops: ['#1a0b24','#2a1345'],
    panelBg: 'rgba(26,20,48,0.88)',
    panelStroke: 'rgba(255,255,255,0.10)',
    ink: '#fff4fa',
    sub: '#ffd9e8',
    accent: '#ff96c8',
    titleGrad: ['#ff9ac3','#ffd6e9'],
    confetti: ['#ffb0d0','#ffd6e9'],
    stickers: 'hearts',
    defaultFont: 'cursive'
  },

  // keep one very neutral
  classic: {
    name: 'Classic Night',
    bgStops: ['#0c1022','#14102e'],
    panelBg: 'rgba(12,16,34,0.88)',
    panelStroke: 'rgba(255,255,255,0.12)',
    ink: '#eaf2ff',
    sub: '#cdd5f9',
    accent: '#ff8fb1',
    titleGrad: ['#ff8fb1','#c9a7ff'],
    confetti: ['#ffffff22','#ffc8dd33','#c9a7ff33'],
    stickers: 'stars',
    defaultFont: 'clean'
  }
};


/* ----------  Formats (everything scales from a base width) ---------- */
const FORMATS = {
  card:   { w:1200, h:720  },
  story:  { w:1080, h:1920 },
  square: { w:1080, h:1080 }
};

/* ----------  QR helper -> returns a <canvas>  ---------- */
/* ---------- QR helper (theme-aware) ---------- */
function makeQRCanvas(text, size=260){
  const c = document.createElement('canvas'); c.width = c.height = size;
  return new Promise((resolve,reject)=>{
    // keep standard black QR on white for scan reliability
    QRCode.toCanvas(
      c, text || location.href,
      { width:size, margin:1, errorCorrectionLevel:'Q', color:{ dark:'#111', light:'#fff' } },
      err => err ? reject(err) : resolve(c)
    );
  });
}

/* ---------- text helpers ---------- */
function wrapLines(ctx, text, maxW){
  const words = (text||'').split(/\s+/); const lines=[]; let line='';
  for(let i=0;i<words.length;i++){
    const test=line+words[i]+' ';
    if(ctx.measureText(test).width>maxW && line){ lines.push(line.trim()); line=words[i]+' '; }
    else line=test;
  }
  if(line) lines.push(line.trim());
  return lines;
}

/* ---------- stickers (cute but subtle) ---------- */
function drawStickers(ctx, W, H, type){
  ctx.save();
  if(type==='hearts'){
    const colors=['#ff9ac3','#ffd6e9','#fff0f6'];
    for(let i=0;i<14;i++){
      ctx.fillStyle = colors[i%colors.length];
      const x = Math.random()*W, y = Math.random()*H*0.35 + 10;
      ctx.globalAlpha = 0.18 + Math.random()*0.18;
      ctx.beginPath();
      ctx.moveTo(x,y);
      ctx.arc(x-6,y,6,0,Math.PI,true);
      ctx.arc(x+6,y,6,0,Math.PI,true);
      ctx.lineTo(x,y+10); ctx.closePath(); ctx.fill();
    }
  } else if(type==='daisies'){
    const petal = (x,y,r,c)=>{ ctx.fillStyle=c; for(let k=0;k<6;k++){ ctx.beginPath(); ctx.ellipse(x,y,r*0.55,r, k*Math.PI/3,0,Math.PI*2); ctx.fill(); } ctx.beginPath(); ctx.fillStyle='#ffd86e'; ctx.arc(x,y,r*0.35,0,Math.PI*2); ctx.fill(); };
    for(let i=0;i<10;i++){ const x= 40+Math.random()*(W-80), y= 30+Math.random()*80; ctx.globalAlpha=.22; petal(x,y,8,['#fff','#fff','#fdfdfd'][i%3]); }
  } else if(type==='ribbons'){
    ctx.globalAlpha=.12; ctx.fillStyle='#b68b2e';
    ctx.fillRect(32,24,120,10); ctx.fillRect(W-160,18,120,10);
  } else if(type==='stars'){
    const dots=160; ctx.globalAlpha=.2; ctx.fillStyle='#ffffff';
    for(let i=0;i<dots;i++){ ctx.fillRect(Math.random()*W, Math.random()*H*0.5, 2, 2); }
  }
  ctx.restore();
}

/* ---------- main painter ---------- */
async function drawPostcard(opts){
  const {
    themeKey='classic',
    title='A little note for you',
    message='',
    url=location.href,
    footer='',
    fontMode='auto',
    format='card'     // card | story | square
  } = opts;

  const theme = THEMES[themeKey] || THEMES.classic;
  const canvas = document.getElementById('pcCanvas') || document.getElementById('card');
  const ctx = canvas.getContext('2d');

  // Sizes
  let W=1200, H=720;
  if(format==='story'){ W=1080; H=1920; }
  if(format==='square'){ W=1080; H=1080; }
  canvas.width=W; canvas.height=H;
  const k = W/1200;                       // scale factor

  // Background gradient
  const bg = ctx.createLinearGradient(0,0,0,H);
  bg.addColorStop(0, theme.bgStops[0]); bg.addColorStop(1, theme.bgStops[1]);
  ctx.fillStyle = bg; ctx.fillRect(0,0,W,H);

  // Confetti/bokeh
  theme.confetti.forEach(col=>{
    ctx.fillStyle = col;
    for(let i=0;i<60;i++){
      const r = Math.random()*2 + 1;
      ctx.globalAlpha = 0.12 + Math.random()*0.15;
      ctx.beginPath();
      ctx.arc(Math.random()*W, Math.random()*H, r, 0, Math.PI*2);
      ctx.fill();
    }
  });
  ctx.globalAlpha = 1;

  // Panel
  const PAD = Math.round(40*k), R = Math.round(22*k), innerPadX = Math.round(26*k);
  const panelX = PAD, panelY = PAD, panelW = W-PAD*2, panelH = H-PAD*2;



  // actual fill + stroke
  ctx.fillStyle = theme.panelBg;
  roundRect(ctx, panelX, panelY, panelW, panelH, R, true, false);
  ctx.strokeStyle = theme.panelStroke; ctx.lineWidth = Math.max(1,2*k);
  roundRect(ctx, panelX, panelY, panelW, panelH, R, false, true);

  // stickers floating in upper half
  drawStickers(ctx, W, Math.min(panelH, H*0.55), theme.stickers);

  // Title (gradient fill)
  const tg = ctx.createLinearGradient(panelX,0,panelX+panelW,0);
  (theme.titleGrad||[theme.accent]).forEach((c,i,a)=> tg.addColorStop(i/(a.length-1||1), c));
  ctx.fillStyle = tg;
  ctx.textAlign='left'; ctx.textBaseline='top';
  ctx.font = `800 ${Math.round(46*k)}px "Fraunces","Playfair Display",serif`;
  ctx.fillText(title, panelX+innerPadX, panelY+Math.round(28*k));

  // divider line
  ctx.strokeStyle = theme.accent; ctx.lineWidth = Math.max(1.5,2*k);
  line(ctx, panelX+innerPadX, panelY+Math.round(82*k), panelX+panelW-innerPadX, panelY+Math.round(82*k));

  // Message font selection
  const mode = (fontMode==='auto') ? (theme.defaultFont||'clean') : fontMode;
  let msgFont;
  if(mode==='clean')   msgFont = `600 ${Math.round(28*k)}px "Quicksand","Poppins",system-ui`;
  if(mode==='cursive') msgFont = `400 ${Math.round(36*k)}px "Pacifico","Satisfy",cursive`;
  if(mode==='elegant') msgFont = `400 ${Math.round(40*k)}px "Great Vibes","Sacramento",cursive`;

  // Message block
  ctx.fillStyle = theme.ink; ctx.font = msgFont; ctx.textAlign = 'left';
  const textX = panelX+innerPadX;
  const textTop = panelY+Math.round(150*k);
  const textMax = panelW - innerPadX*3 - Math.round(320*k);

  // soft heart glyph between text lines (cute, optional)
  const lines = wrapLines(ctx, message, textMax);
  let yy = textTop, lh = (mode==='clean'? 45*k : 46*k);
  lines.forEach((l,i)=>{ ctx.fillText(l, textX, yy); yy += lh; });

  // Footer anchored to bottom inside panel
  if(footer){
    ctx.fillStyle = theme.sub;
    ctx.font = `600 ${Math.round(22*k)}px "Quicksand",sans-serif`;
    const fLines = wrapLines(ctx, footer, panelW - innerPadX*2);
    const fLH = Math.round(34*k);
    const total = fLines.length * fLH;
    let fy = panelY + panelH - innerPadX - total;
    fLines.forEach(l => { ctx.fillText(l, panelX+innerPadX, fy); fy += fLH; });
  }

  // QR area (right)
  const qr = await makeQRCanvas(url, Math.round(280*k));
  const qrX = panelX + panelW - innerPadX - qr.width;
  const qrY = panelY + Math.round(110*k);

  // QR white tile with rounded corners
  ctx.fillStyle = '#fff';
  roundRect(ctx, qrX-10, qrY-10, qr.width+20, qr.height+24, 20*k, true, false);
  ctx.drawImage(qr, qrX, qrY);

  // QR caption
  ctx.fillStyle = theme.sub;
  ctx.font = `600 ${Math.round(18*k)}px "Quicksand",sans-serif`;
  ctx.textAlign = 'center';
  ctx.fillText('Scan karlo isko ab', qrX + qr.width/2, qrY + qr.height + Math.round(26*k));
}

/* ----- basic helpers ----- */
function roundRect(ctx, x, y, w, h, r, fill, stroke){
  if (w < 2 * r) r = w / 2; if (h < 2 * r) r = h / 2;
  ctx.beginPath();
  ctx.moveTo(x+r, y);
  ctx.arcTo(x+w, y,   x+w, y+h, r);
  ctx.arcTo(x+w, y+h, x,   y+h, r);
  ctx.arcTo(x,   y+h, x,   y,   r);
  ctx.arcTo(x,   y,   x+w, y,   r);
  ctx.closePath();
  if (fill) ctx.fill();
  if (stroke) ctx.stroke();
}
function line(ctx, x1,y1,x2,y2){ ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke(); }

/* ---------- wire buttons ---------- */
async function generatePostcard(){
  const themeKey = (document.getElementById('pcTheme') || {}).value || 'classic';
  const fontMode = (document.getElementById('pcFont')  || {}).value || 'auto';
  const title    = (document.getElementById('title')   || {}).value || 'A little note for you';
  const message  = (document.getElementById('msg')     || {}).value || '';
  const url      = (document.getElementById('url')     || {}).value || location.href;
  const footer   = (document.getElementById('footer')  || {}).value || '';
  const format   = (document.getElementById('fmt')     || {}).value || 'card';

  await drawPostcard({ themeKey, title, message, url, footer, fontMode, format });
}
function downloadPNG(){
  const c = document.getElementById('pcCanvas') || document.getElementById('card');
  const a = document.createElement('a'); a.href = c.toDataURL('image/png'); a.download = 'postcard.png'; a.click();
}
(document.getElementById('render')   || document.getElementById('pcGenerate'))?.addEventListener('click', generatePostcard);
(document.getElementById('download') || document.getElementById('pcDownload'))?.addEventListener('click', downloadPNG);

/* initial render */
generatePostcard();

</script>

</body>
</html>
